"0","# Errors by mtry"
"0","p <- ncol(wine_train) - 1  "
"0","mtry_vals <- 1:p"
"0","oob_errors <- numeric(length(mtry_vals))"
"0","test_errors <- numeric(length(mtry_vals))"
"0",""
"0","# Loop over mtry values"
"0","for (i in mtry_vals) {"
"0","  rf_model <- randomForest("
"0","    quality ~ ., "
"0","    data = wine_train,"
"0","    ntree = 300,"
"0","    mtry = i,"
"0","    importance = TRUE"
"0","  )"
"0","  "
"0","  oob_errors[i] <- sqrt(rf_model$mse[300])"
"0","  "
"0","  preds <- predict(rf_model, newdata = wine_test)"
"0","  test_errors[i] <- rmse(wine_test$quality, preds)"
"0","}"
"0",""
"0","# Plot out of bag error mtry"
"0","# OOB error plot"
"0","oob_df <- data.frame(mtry = mtry_vals, OOB_Error = oob_errors)"
"0",""
"0","ggplot(oob_df, aes(x = mtry, y = OOB_Error)) +"
"0","  geom_line(color = ""black"", size = 1.1) +"
"0","  geom_point(color = ""black"") +"
"0","  labs(title = ""Out-of-Bag Error by Number of Predictors"","
"0","       subtitle = ""Figure 3.3"","
"0","       x = ""Number of Predictors"","
"0","       y = ""Out-of-Bag Error"") "
