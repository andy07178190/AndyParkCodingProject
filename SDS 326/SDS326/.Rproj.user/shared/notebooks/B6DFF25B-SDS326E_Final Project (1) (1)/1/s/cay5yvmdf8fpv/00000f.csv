"0","# Lasso Regression"
"0","x_train <- model.matrix(quality ~ ., wine_train)[,-1]"
"0","y_train <- wine_train$quality"
"0",""
"0","x_test <- model.matrix(quality ~ ., wine_test)[,-1]"
"0","y_test <- wine_test$quality"
"0",""
"0","set.seed(123)"
"0","cv_lasso <- cv.glmnet(x_train, y_train, alpha = 1) "
"0",""
"0","# Best lambda value"
"0","best_lambda <- cv_lasso$lambda.min"
"0","cat(""Optimal lambda:"", best_lambda, ""\n"")"
"1","Optimal lambda:"
"1"," "
"1","0.008374202"
"1"," "
"1","
"
"0","# Predict on test set using best lambda"
"0","lasso_pred <- predict(cv_lasso, s = best_lambda, newx = x_test)"
"0",""
"0","# Evaluate"
"0","lasso_rmse <- rmse(y_test, lasso_pred)"
"0","lasso_r2 <- R2(lasso_pred, y_test)"
"0",""
"0","cat(""Lasso Test RMSE:"", round(lasso_rmse, 3), ""\n"")"
"1","Lasso Test RMSE:"
"1"," "
"1","0.651"
"1"," "
"1","
"
"0","cat(""Lasso Test R-squared:"", round(lasso_r2, 3), ""\n"")"
"1","Lasso Test R-squared:"
"1"," "
"1","0.339"
"1"," "
"1","
"
"0","# Examine coefficients"
"0","lasso_coef <- coef(cv_lasso, s = best_lambda)"
"0","print(lasso_coef)"
"1","12 x 1 sparse Matrix of class ""dgCMatrix""
"
"1","                    "
"1","           s1"
"1","
(Intercept)         "
"1","  3.556800921"
"1","
fixed.acidity       "
"1","  0.019936265"
"1","
volatile.acidity    "
"1"," -1.062724543"
"1","
citric.acid         "
"1","  .          "
"1","
residual.sugar      "
"1","  .          "
"1","
chlorides           "
"1"," -1.436719445"
"1","
free.sulfur.dioxide "
"1","  0.003063552"
"1","
total.sulfur.dioxide"
"1"," -0.002379739"
"1","
density             "
"1","  .          "
"1","
pH                  "
"1"," -0.243788277"
"1","
sulphates           "
"1","  0.821716558"
"1","
alcohol             "
"1","  0.281259297"
"1","
"
